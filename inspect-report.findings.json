{"findings": [{"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the RDS is securely encrypted at rest.", "description": "Ensure all data stored in the RDS is securely encrypted at rest.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_16/e6e12555cbcb82d8f4f180ab84058b32", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "RDSEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the RDS is securely encrypted at rest.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/db-app.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_16", "ruleName": "RDSEncryption", "contextText": "1 resource \"aws_db_instance\" \"default\" {\n", "snippetText": "1 resource \"aws_db_instance\" \"default\" {\n  name                   = var.dbname\n  engine                 = \"mysql\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the RDS bucket is not public accessible.", "description": "Ensure all data stored in the RDS bucket is not public accessible.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_17/cca3c3c161f2584028d58d87f7acfdb7", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "RDSPubliclyAccessible", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the RDS bucket is not public accessible.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/db-app.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_17", "ruleName": "RDSPubliclyAccessible", "contextText": "1 resource \"aws_db_instance\" \"default\" {\n", "snippetText": "1 resource \"aws_db_instance\" \"default\" {\n  name                   = var.dbname\n  engine                 = \"mysql\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Instance Metadata Service Version 1 is not enabled.", "description": "Ensure Instance Metadata Service Version 1 is not enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_79/0e7f831d6b25517d4f606ab4199923ec", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "IMDSv1Disabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Instance Metadata Service Version 1 is not enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/db-app.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 178, "ruleId": "CKV_AWS_79", "ruleName": "IMDSv1Disabled", "contextText": "178 resource \"aws_instance\" \"db_app\" {\n", "snippetText": "178 resource \"aws_instance\" \"db_app\" {\n  # ec2 have plain text secrets in user data\n  ami                  = data.aws_ami.amazon-linux-2.id\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the Launch configuration EBS is securely encrypted.", "description": "Ensure all data stored in the Launch configuration EBS is securely encrypted.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_8/b46ca1846d1eb3f3003b1e127d5cf0fe", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "LaunchConfigurationEBSEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the Launch configuration EBS is securely encrypted.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/db-app.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 178, "ruleId": "CKV_AWS_8", "ruleName": "LaunchConfigurationEBSEncryption", "contextText": "178 resource \"aws_instance\" \"db_app\" {\n", "snippetText": "178 resource \"aws_instance\" \"db_app\" {\n  # ec2 have plain text secrets in user data\n  ami                  = data.aws_ami.amazon-linux-2.id\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure no hard coded AWS access key and secret key exists in EC2 user data.", "description": "Ensure no hard coded AWS access key and secret key exists in EC2 user data.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_46/5d17dd14bdb0076c367f038f029e6260", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "EC2Credentials", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure no hard coded AWS access key and secret key exists in EC2 user data.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_46", "ruleName": "EC2Credentials", "contextText": "1 resource \"aws_instance\" \"web_host\" {\n", "snippetText": "1 resource \"aws_instance\" \"web_host\" {\n  # ec2 have plain text secrets in user data\n  ami           = \"${var.ami}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Instance Metadata Service Version 1 is not enabled.", "description": "Ensure Instance Metadata Service Version 1 is not enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_79/440863b4d2493a0e0ffe7a04d1ac837c", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "IMDSv1Disabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Instance Metadata Service Version 1 is not enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_79", "ruleName": "IMDSv1Disabled", "contextText": "1 resource \"aws_instance\" \"web_host\" {\n", "snippetText": "1 resource \"aws_instance\" \"web_host\" {\n  # ec2 have plain text secrets in user data\n  ami           = \"${var.ami}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the Launch configuration EBS is securely encrypted.", "description": "Ensure all data stored in the Launch configuration EBS is securely encrypted.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_8/d2fa19229528f1cc707aeb9947c14949", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "LaunchConfigurationEBSEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the Launch configuration EBS is securely encrypted.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_8", "ruleName": "LaunchConfigurationEBSEncryption", "contextText": "1 resource \"aws_instance\" \"web_host\" {\n", "snippetText": "1 resource \"aws_instance\" \"web_host\" {\n  # ec2 have plain text secrets in user data\n  ami           = \"${var.ami}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the EBS is securely encrypted.", "description": "CIS Benchmark: **2.2.1**\n\nEnsure EBS volume encryption is enabled.\n\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_3/63c289f20a7a50129f7b5a3f98d12716", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "EBSEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the EBS is securely encrypted.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 25, "ruleId": "CKV_AWS_3", "ruleName": "EBSEncryption", "contextText": "25 resource \"aws_ebs_volume\" \"web_host_storage\" {\n", "snippetText": "25 resource \"aws_ebs_volume\" \"web_host_storage\" {\n  # unencrypted volume\n  availability_zone = \"${var.availability_zone}\"\n"}, "tags": [{"key": "cis_category", "value": "2.2.1", "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22.", "description": "CIS Benchmark: **5.2**\n\nEnsure no security groups allow ingress from 0.0.0.0/0 to remote server administration ports.\n\nPublic access to remote server administration ports, such as 22 and 3389, increases resource attack surface and unnecessarily raises the risk of resource compromise.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_24/ac2e58057c28c631ce0562d73488ddfb", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "SecurityGroupUnrestrictedIngress22", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 50, "ruleId": "CKV_AWS_24", "ruleName": "SecurityGroupUnrestrictedIngress22", "contextText": "50 resource \"aws_security_group\" \"web-node\" {\n", "snippetText": "50 resource \"aws_security_group\" \"web-node\" {\n  # security group is open to the world in SSH port\n  name        = \"${local.resource_prefix.value}-sg\"\n"}, "tags": [{"key": "cis_category", "value": 5.2, "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure the S3 bucket has access logging enabled.", "description": "CIS Benchmark: **3.11**\n\nEnsure that Object-level logging for read/write events is enabled for S3 bucket.\n\nEnabling object-level logging will help you meet data compliance requirements within your organization, perform comprehensive security analysis, monitor specific patterns of user behavior in your AWS account or take immediate actions on any object-level API activity using Amazon CloudWatch Events.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_18/f361b3827cad9d688694641ccd0d5419", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3AccessLogs", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure the S3 bucket has access logging enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 171, "ruleId": "CKV_AWS_18", "ruleName": "S3AccessLogs", "contextText": "171 resource \"aws_s3_bucket\" \"flowbucket\" {\n", "snippetText": "171 resource \"aws_s3_bucket\" \"flowbucket\" {\n  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n  force_destroy = true\n"}, "tags": [{"key": "cis_category", "value": 3.11, "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "description": "CIS Benchmark: **2.1.1**\n\nEnsure all S3 buckets employ encryption-at-rest.\n\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_19/e7015482659431ecd6874b5503914eb5", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3Encryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 171, "ruleId": "CKV_AWS_19", "ruleName": "S3Encryption", "contextText": "171 resource \"aws_s3_bucket\" \"flowbucket\" {\n", "snippetText": "171 resource \"aws_s3_bucket\" \"flowbucket\" {\n  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n  force_destroy = true\n"}, "tags": [{"key": "cis_category", "value": "2.1.1", "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure S3 bucket has MFA delete enabled.", "description": "Ensure S3 bucket has MFA delete enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_52/9b711180d83fd5319a715a27943f7026", "severity": "info", "owasp_category": "a6-misconfiguration", "category": "S3MFADelete", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure S3 bucket has MFA delete enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 171, "ruleId": "CKV_AWS_52", "ruleName": "S3MFADelete", "contextText": "171 resource \"aws_s3_bucket\" \"flowbucket\" {\n", "snippetText": "171 resource \"aws_s3_bucket\" \"flowbucket\" {\n  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n  force_destroy = true\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the S3 bucket have versioning enabled.", "description": "Ensure all data stored in the S3 bucket have versioning enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_21/87bf3266e7edb7c4641b7e005c646c4a", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "S3Versioning", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the S3 bucket have versioning enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ec2.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 171, "ruleId": "CKV_AWS_21", "ruleName": "S3Versioning", "contextText": "171 resource \"aws_s3_bucket\" \"flowbucket\" {\n", "snippetText": "171 resource \"aws_s3_bucket\" \"flowbucket\" {\n  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n  force_destroy = true\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure ECR image scanning on push is enabled.", "description": "Ensure ECR image scanning on push is enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_33/f3f8651360fb41355cc717ae8b0cbd97", "severity": "info", "owasp_category": "a6-misconfiguration", "category": "ECRImageScanning", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure ECR image scanning on push is enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ecr.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_33", "ruleName": "ECRImageScanning", "contextText": "1 resource aws_ecr_repository \"repository\" {\n", "snippetText": "1 resource aws_ecr_repository \"repository\" {\n  name                 = \"${local.resource_prefix.value}-repository\"\n  image_tag_mutability = \"MUTABLE\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure ECR Image Tags are immutable.", "description": "Ensure ECR Image Tags are immutable.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_51/d3a601a499cb4b44673038ba8c05a4a8", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "ECRImmutableTags", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure ECR Image Tags are immutable.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/ecr.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_51", "ruleName": "ECRImmutableTags", "contextText": "1 resource aws_ecr_repository \"repository\" {\n", "snippetText": "1 resource aws_ecr_repository \"repository\" {\n  name                 = \"${local.resource_prefix.value}-repository\"\n  image_tag_mutability = \"MUTABLE\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Amazon EKS control plane logging enabled for all log types.", "description": "Ensure Amazon EKS control plane logging enabled for all log types.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_37/66b4dec2a2e3078786ac0b56afd14ffc", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "EKSControlPlaneLogging", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Amazon EKS control plane logging enabled for all log types.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/eks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 64, "ruleId": "CKV_AWS_37", "ruleName": "EKSControlPlaneLogging", "contextText": "64 resource aws_eks_cluster \"eks_cluster\" {\n", "snippetText": "64 resource aws_eks_cluster \"eks_cluster\" {\n  name     = local.eks_name.value\n  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Amazon EKS public endpoint disabled.", "description": "Ensure Amazon EKS public endpoint disabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_39/825b46196e85e96931d199fefd443872", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "EKSPublicAccess", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Amazon EKS public endpoint disabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/eks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 64, "ruleId": "CKV_AWS_39", "ruleName": "EKSPublicAccess", "contextText": "64 resource aws_eks_cluster \"eks_cluster\" {\n", "snippetText": "64 resource aws_eks_cluster \"eks_cluster\" {\n  name     = local.eks_name.value\n  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0.", "description": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_38/8835053cd4b92bbcd46f5f6443467d4d", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "EKSPublicAccessCIDR", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/eks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 64, "ruleId": "CKV_AWS_38", "ruleName": "EKSPublicAccessCIDR", "contextText": "64 resource aws_eks_cluster \"eks_cluster\" {\n", "snippetText": "64 resource aws_eks_cluster \"eks_cluster\" {\n  name     = local.eks_name.value\n  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure EKS Cluster has Secrets Encryption Enabled.", "description": "Ensure EKS Cluster has Secrets Encryption Enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_58/6b745766c54af2028c45bff1d6de91a2", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "EKSSecretsEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure EKS Cluster has Secrets Encryption Enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/eks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 64, "ruleId": "CKV_AWS_58", "ruleName": "EKSSecretsEncryption", "contextText": "64 resource aws_eks_cluster \"eks_cluster\" {\n", "snippetText": "64 resource aws_eks_cluster \"eks_cluster\" {\n  name     = local.eks_name.value\n  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the Elasticsearch is securely encrypted at rest.", "description": "Ensure all data stored in the Elasticsearch is securely encrypted at rest.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_5/d632cc4c7ffbc16045ceb88b78867d8b", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "ElasticsearchEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the Elasticsearch is securely encrypted at rest.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/es.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_5", "ruleName": "ElasticsearchEncryption", "contextText": "1 resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n", "snippetText": "1 resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n  domain_name           = \"tg-${var.environment}-es\"\n  elasticsearch_version = \"2.3\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.).", "description": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.).\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_40/cfd462228bb69c45f37e19b9fb8a3e52", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "IAMPolicyAttachedToGroupOrRoles", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure IAM policies are attached only to groups or roles (Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.).", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/iam.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 16, "ruleId": "CKV_AWS_40", "ruleName": "IAMPolicyAttachedToGroupOrRoles", "contextText": "16 resource \"aws_iam_user_policy\" \"userpolicy\" {\n", "snippetText": "16 resource \"aws_iam_user_policy\" \"userpolicy\" {\n  name = \"excess_policy\"\n  user = \"${aws_iam_user.user.name}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure rotation for customer created CMKs is enabled.", "description": "CIS Benchmark: **3.8**\n\nEnsure rotation for customer created CMKs is enabled.\n\nRotating encryption keys helps reduce the potential impact of a compromised key as data encrypted with a new key cannot be accessed with a previous key that may have been exposed.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_7/c18fd2108b0e7deab3fd4eda50db716e", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "KMSRotation", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure rotation for customer created CMKs is enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/kms.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_7", "ruleName": "KMSRotation", "contextText": "1 resource \"aws_kms_key\" \"logs_key\" {\n", "snippetText": "1 resource \"aws_kms_key\" \"logs_key\" {\n  # key does not have rotation enabled\n  description = \"${local.resource_prefix.value}-logs bucket key\"\n"}, "tags": [{"key": "cis_category", "value": 3.8, "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure no hard coded AWS access key and secret key exists in lambda environment.", "description": "Ensure no hard coded AWS access key and secret key exists in lambda environment.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_45/774a7dae3f4f2d249c32ce934e1a9c22", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "LambdaEnvironmentCredentials", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure no hard coded AWS access key and secret key exists in lambda environment.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/lambda.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 21, "ruleId": "CKV_AWS_45", "ruleName": "LambdaEnvironmentCredentials", "contextText": "21 resource \"aws_lambda_function\" \"analysis_lambda\" {\n", "snippetText": "21 resource \"aws_lambda_function\" \"analysis_lambda\" {\n  # lambda have plain text secrets in environment variables\n  filename      = \"resources/lambda_function_payload.zip\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "X-ray tracing is enabled for Lambda.", "description": "X-ray tracing is enabled for Lambda.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_50/a13f9dcd998ce195c71c49ba6525dabe", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "LambdaXrayEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "X-ray tracing is enabled for Lambda.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/lambda.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 21, "ruleId": "CKV_AWS_50", "ruleName": "LambdaXrayEnabled", "contextText": "21 resource \"aws_lambda_function\" \"analysis_lambda\" {\n", "snippetText": "21 resource \"aws_lambda_function\" \"analysis_lambda\" {\n  # lambda have plain text secrets in environment variables\n  filename      = \"resources/lambda_function_payload.zip\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Neptune storage is securely encrypted.", "description": "Ensure Neptune storage is securely encrypted.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_44/5030a8db6a093d282a8767f0d5687290", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "NeptuneClusterStorageEncrypted", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Neptune storage is securely encrypted.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/neptune.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_44", "ruleName": "NeptuneClusterStorageEncrypted", "contextText": "1 resource \"aws_neptune_cluster\" \"default\" {\n", "snippetText": "1 resource \"aws_neptune_cluster\" \"default\" {\n  cluster_identifier                  = var.neptune-dbname\n  engine                              = \"neptune\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure no hard coded AWS access key and and secret key exists in provider.", "description": "Ensure no hard coded AWS access key and and secret key exists in provider.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_41/3b5001946074b8b9a17f2dbb29d7cb06", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "credentials", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure no hard coded AWS access key and and secret key exists in provider.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/providers.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 7, "ruleId": "CKV_AWS_41", "ruleName": "credentials", "contextText": "7 provider \"aws\" {\n", "snippetText": "7 provider \"aws\" {\n  alias      = \"plain_text_access_keys_provider\"\n  region     = \"us-west-1\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure the S3 bucket has access logging enabled.", "description": "CIS Benchmark: **3.11**\n\nEnsure that Object-level logging for read/write events is enabled for S3 bucket.\n\nEnabling object-level logging will help you meet data compliance requirements within your organization, perform comprehensive security analysis, monitor specific patterns of user behavior in your AWS account or take immediate actions on any object-level API activity using Amazon CloudWatch Events.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_18/8093f5f13859def4cc6ab142d10a2102", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3AccessLogs", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure the S3 bucket has access logging enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_18", "ruleName": "S3AccessLogs", "contextText": "1 resource \"aws_s3_bucket\" \"data\" {\n", "snippetText": "1 resource \"aws_s3_bucket\" \"data\" {\n  # bucket is public\n  # bucket is not encrypted\n"}, "tags": [{"key": "cis_category", "value": 3.11, "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "description": "CIS Benchmark: **2.1.1**\n\nEnsure all S3 buckets employ encryption-at-rest.\n\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_19/d5d1f1f81dc76f581ba57abf0a4ddeba", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3Encryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_19", "ruleName": "S3Encryption", "contextText": "1 resource \"aws_s3_bucket\" \"data\" {\n", "snippetText": "1 resource \"aws_s3_bucket\" \"data\" {\n  # bucket is public\n  # bucket is not encrypted\n"}, "tags": [{"key": "cis_category", "value": "2.1.1", "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure S3 bucket has MFA delete enabled.", "description": "Ensure S3 bucket has MFA delete enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_52/445c8803af569bd359a0f8efd80ef17f", "severity": "info", "owasp_category": "a6-misconfiguration", "category": "S3MFADelete", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure S3 bucket has MFA delete enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_52", "ruleName": "S3MFADelete", "contextText": "1 resource \"aws_s3_bucket\" \"data\" {\n", "snippetText": "1 resource \"aws_s3_bucket\" \"data\" {\n  # bucket is public\n  # bucket is not encrypted\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "S3 Bucket has an ACL defined which allows public READ access.", "description": "S3 Bucket has an ACL defined which allows public READ access.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_20/86b449e117e4338772d1f6257239ead4", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3PublicACLRead", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "S3 Bucket has an ACL defined which allows public READ access.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_20", "ruleName": "S3PublicACLRead", "contextText": "1 resource \"aws_s3_bucket\" \"data\" {\n", "snippetText": "1 resource \"aws_s3_bucket\" \"data\" {\n  # bucket is public\n  # bucket is not encrypted\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the S3 bucket have versioning enabled.", "description": "Ensure all data stored in the S3 bucket have versioning enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_21/8d70543f5986096f159bbe549f20d582", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "S3Versioning", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the S3 bucket have versioning enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AWS_21", "ruleName": "S3Versioning", "contextText": "1 resource \"aws_s3_bucket\" \"data\" {\n", "snippetText": "1 resource \"aws_s3_bucket\" \"data\" {\n  # bucket is public\n  # bucket is not encrypted\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure the S3 bucket has access logging enabled.", "description": "CIS Benchmark: **3.11**\n\nEnsure that Object-level logging for read/write events is enabled for S3 bucket.\n\nEnabling object-level logging will help you meet data compliance requirements within your organization, perform comprehensive security analysis, monitor specific patterns of user behavior in your AWS account or take immediate actions on any object-level API activity using Amazon CloudWatch Events.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_18/bfab3d4f3a14e53ad5c3750aa47a7203", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3AccessLogs", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure the S3 bucket has access logging enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 25, "ruleId": "CKV_AWS_18", "ruleName": "S3AccessLogs", "contextText": "25 resource \"aws_s3_bucket\" \"financials\" {\n", "snippetText": "25 resource \"aws_s3_bucket\" \"financials\" {\n  # bucket is not encrypted\n  # bucket does not have access logs\n"}, "tags": [{"key": "cis_category", "value": 3.11, "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "description": "CIS Benchmark: **2.1.1**\n\nEnsure all S3 buckets employ encryption-at-rest.\n\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_19/659c8cfefb3da7867c6e9b5f4bbfa6b3", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3Encryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 25, "ruleId": "CKV_AWS_19", "ruleName": "S3Encryption", "contextText": "25 resource \"aws_s3_bucket\" \"financials\" {\n", "snippetText": "25 resource \"aws_s3_bucket\" \"financials\" {\n  # bucket is not encrypted\n  # bucket does not have access logs\n"}, "tags": [{"key": "cis_category", "value": "2.1.1", "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure S3 bucket has MFA delete enabled.", "description": "Ensure S3 bucket has MFA delete enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_52/b6a4d5de6bd2d0c2465be799f051c465", "severity": "info", "owasp_category": "a6-misconfiguration", "category": "S3MFADelete", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure S3 bucket has MFA delete enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 25, "ruleId": "CKV_AWS_52", "ruleName": "S3MFADelete", "contextText": "25 resource \"aws_s3_bucket\" \"financials\" {\n", "snippetText": "25 resource \"aws_s3_bucket\" \"financials\" {\n  # bucket is not encrypted\n  # bucket does not have access logs\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the S3 bucket have versioning enabled.", "description": "Ensure all data stored in the S3 bucket have versioning enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_21/2dd0535cdcffc86b274e2a6e0e3dd9f4", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "S3Versioning", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the S3 bucket have versioning enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 25, "ruleId": "CKV_AWS_21", "ruleName": "S3Versioning", "contextText": "25 resource \"aws_s3_bucket\" \"financials\" {\n", "snippetText": "25 resource \"aws_s3_bucket\" \"financials\" {\n  # bucket is not encrypted\n  # bucket does not have access logs\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure the S3 bucket has access logging enabled.", "description": "CIS Benchmark: **3.11**\n\nEnsure that Object-level logging for read/write events is enabled for S3 bucket.\n\nEnabling object-level logging will help you meet data compliance requirements within your organization, perform comprehensive security analysis, monitor specific patterns of user behavior in your AWS account or take immediate actions on any object-level API activity using Amazon CloudWatch Events.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_18/f4546eba91fb259e967f0c90ca1712c9", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3AccessLogs", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure the S3 bucket has access logging enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 39, "ruleId": "CKV_AWS_18", "ruleName": "S3AccessLogs", "contextText": "39 resource \"aws_s3_bucket\" \"operations\" {\n", "snippetText": "39 resource \"aws_s3_bucket\" \"operations\" {\n  # bucket is not encrypted\n  # bucket does not have access logs\n"}, "tags": [{"key": "cis_category", "value": 3.11, "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "description": "CIS Benchmark: **2.1.1**\n\nEnsure all S3 buckets employ encryption-at-rest.\n\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_19/9d56817d78666680bc9c13da3c68f5fe", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3Encryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 39, "ruleId": "CKV_AWS_19", "ruleName": "S3Encryption", "contextText": "39 resource \"aws_s3_bucket\" \"operations\" {\n", "snippetText": "39 resource \"aws_s3_bucket\" \"operations\" {\n  # bucket is not encrypted\n  # bucket does not have access logs\n"}, "tags": [{"key": "cis_category", "value": "2.1.1", "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure S3 bucket has MFA delete enabled.", "description": "Ensure S3 bucket has MFA delete enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_52/3a0fc1e3f12bbe0c77e83d3188773138", "severity": "info", "owasp_category": "a6-misconfiguration", "category": "S3MFADelete", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure S3 bucket has MFA delete enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 39, "ruleId": "CKV_AWS_52", "ruleName": "S3MFADelete", "contextText": "39 resource \"aws_s3_bucket\" \"operations\" {\n", "snippetText": "39 resource \"aws_s3_bucket\" \"operations\" {\n  # bucket is not encrypted\n  # bucket does not have access logs\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "description": "CIS Benchmark: **2.1.1**\n\nEnsure all S3 buckets employ encryption-at-rest.\n\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_19/32f4ae74c8a544aa72745a9054fd91c4", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3Encryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all data stored in the S3 bucket is securely encrypted at rest.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 55, "ruleId": "CKV_AWS_19", "ruleName": "S3Encryption", "contextText": "55 resource \"aws_s3_bucket\" \"data_science\" {\n", "snippetText": "55 resource \"aws_s3_bucket\" \"data_science\" {\n  # bucket is not encrypted\n  bucket = \"${local.resource_prefix.value}-data-science\"\n"}, "tags": [{"key": "cis_category", "value": "2.1.1", "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure S3 bucket has MFA delete enabled.", "description": "Ensure S3 bucket has MFA delete enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_52/d843eeaeb9eb098a3ca09e4d5679901d", "severity": "info", "owasp_category": "a6-misconfiguration", "category": "S3MFADelete", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure S3 bucket has MFA delete enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 55, "ruleId": "CKV_AWS_52", "ruleName": "S3MFADelete", "contextText": "55 resource \"aws_s3_bucket\" \"data_science\" {\n", "snippetText": "55 resource \"aws_s3_bucket\" \"data_science\" {\n  # bucket is not encrypted\n  bucket = \"${local.resource_prefix.value}-data-science\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure the S3 bucket has access logging enabled.", "description": "CIS Benchmark: **3.11**\n\nEnsure that Object-level logging for read/write events is enabled for S3 bucket.\n\nEnabling object-level logging will help you meet data compliance requirements within your organization, perform comprehensive security analysis, monitor specific patterns of user behavior in your AWS account or take immediate actions on any object-level API activity using Amazon CloudWatch Events.\n\n## Remediation\n\nRefer to the provider documentation for the configuration options available.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_18/629ac4abc0dd566ba89f288b844a68f1", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "S3AccessLogs", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure the S3 bucket has access logging enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 69, "ruleId": "CKV_AWS_18", "ruleName": "S3AccessLogs", "contextText": "69 resource \"aws_s3_bucket\" \"logs\" {\n", "snippetText": "69 resource \"aws_s3_bucket\" \"logs\" {\n  bucket = \"${local.resource_prefix.value}-logs\"\n  acl    = \"log-delivery-write\"\n"}, "tags": [{"key": "cis_category", "value": 3.11, "shiftleft_managed": false}, {"key": "cis_status", "value": "SCORED", "shiftleft_managed": false}]}, {"app": "terragoat", "type": "extscan", "title": "Ensure S3 bucket has MFA delete enabled.", "description": "Ensure S3 bucket has MFA delete enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AWS_52/ea0a0b68c59f6ff2e357af52e129e635", "severity": "info", "owasp_category": "a6-misconfiguration", "category": "S3MFADelete", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure S3 bucket has MFA delete enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/aws/s3.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 69, "ruleId": "CKV_AWS_52", "ruleName": "S3MFADelete", "contextText": "69 resource \"aws_s3_bucket\" \"logs\" {\n", "snippetText": "69 resource \"aws_s3_bucket\" \"logs\" {\n  bucket = \"${local.resource_prefix.value}-logs\"\n  acl    = \"log-delivery-write\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure AKS has an API Server Authorized IP Ranges enabled.", "description": "Ensure AKS has an API Server Authorized IP Ranges enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_6/7e372cc202b049f081e97a2d98a18948", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AKSApiServerAuthorizedIpRanges", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure AKS has an API Server Authorized IP Ranges enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/aks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_6", "ruleName": "AKSApiServerAuthorizedIpRanges", "contextText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n", "snippetText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n  dns_prefix          = \"terragoat-${var.environment}\"\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Kube Dashboard is disabled.", "description": "Ensure Kube Dashboard is disabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_8/b04639a94651bd941f926d464a319108", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AKSDashboardDisabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Kube Dashboard is disabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/aks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_8", "ruleName": "AKSDashboardDisabled", "contextText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n", "snippetText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n  dns_prefix          = \"terragoat-${var.environment}\"\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure AKS logging to Azure Monitoring is Configured.", "description": "Ensure AKS logging to Azure Monitoring is Configured.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_4/666b58b91f2bb9165becb9ba30d0e266", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AKSLoggingEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure AKS logging to Azure Monitoring is Configured.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/aks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_4", "ruleName": "AKSLoggingEnabled", "contextText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n", "snippetText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n  dns_prefix          = \"terragoat-${var.environment}\"\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure AKS cluster has Network Policy configured.", "description": "Ensure AKS cluster has Network Policy configured.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_7/b82009619bfbbbc1676723679aa83e6f", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AKSNetworkPolicy", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure AKS cluster has Network Policy configured.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/aks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_7", "ruleName": "AKSNetworkPolicy", "contextText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n", "snippetText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n  dns_prefix          = \"terragoat-${var.environment}\"\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure RBAC is enabled on AKS clusters.", "description": "Ensure RBAC is enabled on AKS clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_5/eb0dbeb472a3934fe05781eb48f3353b", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AKSRbacEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure RBAC is enabled on AKS clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/aks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_5", "ruleName": "AKSRbacEnabled", "contextText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n", "snippetText": "1 resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n  dns_prefix          = \"terragoat-${var.environment}\"\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure App Service Authentication is set on Azure App Service.", "description": "Ensure App Service Authentication is set on Azure App Service.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_13/8169418b2376c67e46f5407258e4efc7", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServiceAuthentication", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure App Service Authentication is set on Azure App Service.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 12, "ruleId": "CKV_AZURE_13", "ruleName": "AppServiceAuthentication", "contextText": "12 resource azurerm_app_service \"app-service1\" {\n", "snippetText": "12 resource azurerm_app_service \"app-service1\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service.", "description": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_14/24598d5337abd9d14282ddda4293d3d1", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServiceHTTPSOnly", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 12, "ruleId": "CKV_AZURE_14", "ruleName": "AppServiceHTTPSOnly", "contextText": "12 resource azurerm_app_service \"app-service1\" {\n", "snippetText": "12 resource azurerm_app_service \"app-service1\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'HTTP Version' is the latest if used to run the web app.", "description": "Ensure that `HTTP Version` is the latest if used to run the web app.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_18/842353ed75eea7f2cddb956761902072", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServiceHttps20Enabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'HTTP Version' is the latest if used to run the web app.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 12, "ruleId": "CKV_AZURE_18", "ruleName": "AppServiceHttps20Enabled", "contextText": "12 resource azurerm_app_service \"app-service1\" {\n", "snippetText": "12 resource azurerm_app_service \"app-service1\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure web app is using the latest version of TLS encryption.", "description": "Ensure web app is using the latest version of TLS encryption.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_15/087c63ca1879b7393a2c29181bdc058e", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServiceMinTLSVersion", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure web app is using the latest version of TLS encryption.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 12, "ruleId": "CKV_AZURE_15", "ruleName": "AppServiceMinTLSVersion", "contextText": "12 resource azurerm_app_service \"app-service1\" {\n", "snippetText": "12 resource azurerm_app_service \"app-service1\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set.", "description": "Ensure the web app has `Client Certificates (Incoming client certificates)` set.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_17/6c32274e9b5e5f1de36f4f3a75afec7c", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServieClientCertificate", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 12, "ruleId": "CKV_AZURE_17", "ruleName": "AppServieClientCertificate", "contextText": "12 resource azurerm_app_service \"app-service1\" {\n", "snippetText": "12 resource azurerm_app_service \"app-service1\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that Register with Azure Active Directory is enabled on App Service.", "description": "Ensure that Register with Azure Active Directory is enabled on App Service.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_16/7183b0bebdea31e76428023b54097d62", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServieIdentity", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that Register with Azure Active Directory is enabled on App Service.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 12, "ruleId": "CKV_AZURE_16", "ruleName": "AppServieIdentity", "contextText": "12 resource azurerm_app_service \"app-service1\" {\n", "snippetText": "12 resource azurerm_app_service \"app-service1\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure App Service Authentication is set on Azure App Service.", "description": "Ensure App Service Authentication is set on Azure App Service.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_13/86271533da6abf78e6d12ed2806bf449", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServiceAuthentication", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure App Service Authentication is set on Azure App Service.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 23, "ruleId": "CKV_AZURE_13", "ruleName": "AppServiceAuthentication", "contextText": "23 resource azurerm_app_service \"app-service2\" {\n", "snippetText": "23 resource azurerm_app_service \"app-service2\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'HTTP Version' is the latest if used to run the web app.", "description": "Ensure that `HTTP Version` is the latest if used to run the web app.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_18/f3415f3ca58a7e2a6ba9313bbc9016a6", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServiceHttps20Enabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'HTTP Version' is the latest if used to run the web app.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 23, "ruleId": "CKV_AZURE_18", "ruleName": "AppServiceHttps20Enabled", "contextText": "23 resource azurerm_app_service \"app-service2\" {\n", "snippetText": "23 resource azurerm_app_service \"app-service2\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set.", "description": "Ensure the web app has `Client Certificates (Incoming client certificates)` set.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_17/f127d5cf12ceea9295048588db82d750", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServieClientCertificate", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 23, "ruleId": "CKV_AZURE_17", "ruleName": "AppServieClientCertificate", "contextText": "23 resource azurerm_app_service \"app-service2\" {\n", "snippetText": "23 resource azurerm_app_service \"app-service2\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that Register with Azure Active Directory is enabled on App Service.", "description": "Ensure that Register with Azure Active Directory is enabled on App Service.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_16/7e3f474650b2316b2d29617f42763e59", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AppServieIdentity", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that Register with Azure Active Directory is enabled on App Service.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/app_service.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 23, "ruleId": "CKV_AZURE_16", "ruleName": "AppServieIdentity", "contextText": "23 resource azurerm_app_service \"app-service2\" {\n", "snippetText": "23 resource azurerm_app_service \"app-service2\" {\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  location            = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead).", "description": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead).\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_1/a6cf8836a9c7cb3195571aa05c8dd161", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "AzureInstancePassword", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead).", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/instance.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 9, "ruleId": "CKV_AZURE_1", "ruleName": "AzureInstancePassword", "contextText": "9 resource azurerm_linux_virtual_machine \"linux_machine\" {\n", "snippetText": "9 resource azurerm_linux_virtual_machine \"linux_machine\" {\n  admin_username                  = \"terragoat-linux\"\n  admin_password                  = random_string.password.result\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure the key vault is recoverable.", "description": "Ensure the key vault is recoverable.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_42/35a2a0a1bb75072129ccccb6448a88dd", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "KeyvaultRecoveryEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure the key vault is recoverable.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/key_vault.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_42", "ruleName": "KeyvaultRecoveryEnabled", "contextText": "1 resource \"azurerm_key_vault\" \"example\" {\n", "snippetText": "1 resource \"azurerm_key_vault\" \"example\" {\n  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"\n  location            = azurerm_resource_group.example.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that the expiration date is set on all keys.", "description": "Ensure that the expiration date is set on all keys.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_40/443b48140aeb0a00d03460bd9d481c6c", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "KeyExpirationDate", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that the expiration date is set on all keys.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/key_vault.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 24, "ruleId": "CKV_AZURE_40", "ruleName": "KeyExpirationDate", "contextText": "24 resource \"azurerm_key_vault_key\" \"generated\" {\n", "snippetText": "24 resource \"azurerm_key_vault_key\" \"generated\" {\n  name         = \"terragoat-generated-certificate-${var.environment}\"\n  key_vault_id = azurerm_key_vault.example.id\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that the expiration date is set on all secrets.", "description": "Ensure that the expiration date is set on all secrets.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_41/5c623e455b2d95edad5fad591eec821e", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SecretExpirationDate", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that the expiration date is set on all secrets.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/key_vault.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 39, "ruleId": "CKV_AZURE_41", "ruleName": "SecretExpirationDate", "contextText": "39 resource \"azurerm_key_vault_secret\" \"secret\" {\n", "snippetText": "39 resource \"azurerm_key_vault_secret\" \"secret\" {\n  key_vault_id = azurerm_key_vault.example.id\n  name         = \"terragoat-secret-${var.environment}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure audit profile captures all the activities.", "description": "Ensure audit profile captures all the activities.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_38/d66dbcf6510fb77bebaf7c61281ea53f", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "MonitorLogProfileCategories", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure audit profile captures all the activities.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/logging.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_38", "ruleName": "MonitorLogProfileCategories", "contextText": "1 resource azurerm_monitor_log_profile \"logging_profile\" {\n", "snippetText": "1 resource azurerm_monitor_log_profile \"logging_profile\" {\n  storage_account_id = azurerm_storage_account.example.id\n  categories         = [\"Action\"]\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that Activity Log Retention is set 365 days or greater.", "description": "Ensure that Activity Log Retention is set 365 days or greater.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_37/d88453f3978fc0dddbc62a4b20ff2047", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "MonitorLogProfileRetentionDays", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that Activity Log Retention is set 365 days or greater.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/logging.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_37", "ruleName": "MonitorLogProfileRetentionDays", "contextText": "1 resource azurerm_monitor_log_profile \"logging_profile\" {\n", "snippetText": "1 resource azurerm_monitor_log_profile \"logging_profile\" {\n  storage_account_id = azurerm_storage_account.example.id\n  categories         = [\"Action\"]\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that RDP access is restricted from the internet.", "description": "Ensure that RDP access is restricted from the internet.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_9/74d09c2e57fd1be6fda493ce00015468", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "NSGRuleRDPAccessRestricted", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that RDP access is restricted from the internet.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/networking.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 39, "ruleId": "CKV_AZURE_9", "ruleName": "NSGRuleRDPAccessRestricted", "contextText": "39 resource azurerm_network_security_group \"bad_sg\" {\n", "snippetText": "39 resource azurerm_network_security_group \"bad_sg\" {\n  location            = var.location\n  name                = \"terragoat-${var.environment}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that SSH access is restricted from the internet.", "description": "Ensure that SSH access is restricted from the internet.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_10/cd18b7c58187a983441f739bd1e97af5", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "NSGRuleSSHAccessRestricted", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that SSH access is restricted from the internet.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/networking.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 39, "ruleId": "CKV_AZURE_10", "ruleName": "NSGRuleSSHAccessRestricted", "contextText": "39 resource azurerm_network_security_group \"bad_sg\" {\n", "snippetText": "39 resource azurerm_network_security_group \"bad_sg\" {\n  location            = var.location\n  name                = \"terragoat-${var.environment}\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'.", "description": "Ensure that Network Security Group Flow Log retention period is `greater than 90 days`.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_12/ee1c1f4d0fc1fe9f287c7fbde3da67d1", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "NetworkWatcherFlowLogPeriod", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/networking.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 75, "ruleId": "CKV_AZURE_12", "ruleName": "NetworkWatcherFlowLogPeriod", "contextText": "75 resource azurerm_network_watcher_flow_log \"flow_log\" {\n", "snippetText": "75 resource azurerm_network_watcher_flow_log \"flow_log\" {\n  enabled                   = false\n  network_security_group_id = azurerm_network_security_group.bad_sg.id\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that no custom subscription owner roles are created.", "description": "Ensure that no custom subscription owner roles are created.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_39/ae6566b48a08f971b803ab8f42bfa1f5", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "CutsomRoleDefinitionSubscriptionOwner", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that no custom subscription owner roles are created.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/roles.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 3, "ruleId": "CKV_AZURE_39", "ruleName": "CutsomRoleDefinitionSubscriptionOwner", "contextText": "3 resource \"azurerm_role_definition\" \"example\" {\n", "snippetText": "3 resource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.current_subscription.id\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that standard pricing tier is selected.", "description": "Ensure that standard pricing tier is selected.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_19/c6748c925e2c2dfce144b624bb389fbb", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SecurityCenterStandardPricing", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that standard pricing tier is selected.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/security_center.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_19", "ruleName": "SecurityCenterStandardPricing", "contextText": "1 resource azurerm_security_center_subscription_pricing \"pricing\" {\n", "snippetText": "1 resource azurerm_security_center_subscription_pricing \"pricing\" {\n  tier = \"Free\"\n}\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'Send email notification for high severity alerts' is set to 'On'.", "description": "Ensure that `Send email notification for high severity alerts` is set to `On`.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_21/3da6b9aff47cdabe40fd2aa54dac655a", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SecurityCenterContactEmailAlert", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'Send email notification for high severity alerts' is set to 'On'.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/security_center.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 5, "ruleId": "CKV_AZURE_21", "ruleName": "SecurityCenterContactEmailAlert", "contextText": "5 resource azurerm_security_center_contact \"contact\" {\n", "snippetText": "5 resource azurerm_security_center_contact \"contact\" {\n  alert_notifications = false\n  alerts_to_admins    = false\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'Send email notification for high severity alerts' is set to 'On'.", "description": "Ensure that `Send email notification for high severity alerts` is set to `On`.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_22/3da6b9aff47cdabe40fd2aa54dac655a", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SecurityCenterContactEmailAlertAdmins", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'Send email notification for high severity alerts' is set to 'On'.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/security_center.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 5, "ruleId": "CKV_AZURE_22", "ruleName": "SecurityCenterContactEmailAlertAdmins", "contextText": "5 resource azurerm_security_center_contact \"contact\" {\n", "snippetText": "5 resource azurerm_security_center_contact \"contact\" {\n  alert_notifications = false\n  alerts_to_admins    = false\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that security contact 'Phone number' is set.", "description": "Ensure that security contact `Phone number` is set.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_20/2e4ca3480c96d49e780b035f36a64c43", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SecurityCenterContactPhone", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that security contact 'Phone number' is set.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/security_center.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 5, "ruleId": "CKV_AZURE_20", "ruleName": "SecurityCenterContactPhone", "contextText": "5 resource azurerm_security_center_contact \"contact\" {\n", "snippetText": "5 resource azurerm_security_center_contact \"contact\" {\n  alert_notifications = false\n  alerts_to_admins    = false\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'Auditing' is set to 'On' for SQL servers.", "description": "Ensure that `Auditing` is set to `On` for SQL servers.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_23/668fb9e0d6fc99324b3bfdeda0962709", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SQLServerAuditingEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'Auditing' is set to 'On' for SQL servers.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 9, "ruleId": "CKV_AZURE_23", "ruleName": "SQLServerAuditingEnabled", "contextText": "9 resource \"azurerm_sql_server\" \"example\" {\n", "snippetText": "9 resource \"azurerm_sql_server\" \"example\" {\n  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"\n  resource_group_name          = azurerm_resource_group.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers.", "description": "Ensure that `Auditing` Retention is `greater than 90 days` for SQL servers.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_24/ffe9afd6afc0f279d8c003235d080fb0", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SQLServerAuditingRetention90Days", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 9, "ruleId": "CKV_AZURE_24", "ruleName": "SQLServerAuditingRetention90Days", "contextText": "9 resource \"azurerm_sql_server\" \"example\" {\n", "snippetText": "9 resource \"azurerm_sql_server\" \"example\" {\n  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"\n  resource_group_name          = azurerm_resource_group.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'Send Alerts To' is enabled for MSSQL servers.", "description": "Ensure that `Send Alerts To` is enabled for MSSQL servers.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_26/0a88ed89414ae7f298f6ffc6cbebaa72", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SQLServerEmailAlertsEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 22, "ruleId": "CKV_AZURE_26", "ruleName": "SQLServerEmailAlertsEnabled", "contextText": "22 resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n", "snippetText": "22 resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers.", "description": "Ensure that `Email service and co-administrators` is `Enabled` for MSSQL servers.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_27/56fff4d04aa83d277ae44dd70db5310f", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SQLServerEmailAlertsToAdminsEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 22, "ruleId": "CKV_AZURE_27", "ruleName": "SQLServerEmailAlertsToAdminsEnabled", "contextText": "22 resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n", "snippetText": "22 resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'Threat Detection types' is set to 'All'.", "description": "Ensure that `Threat Detection types` is set to `All`.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_25/2f794497c8f0f695a5afb4b1f7c5d0f6", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "SQLServerThreatDetectionTypes", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'Threat Detection types' is set to 'All'.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 22, "ruleId": "CKV_AZURE_25", "ruleName": "SQLServerThreatDetectionTypes", "contextText": "22 resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n", "snippetText": "22 resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for MySQL Database Server.", "description": "Ensure `Enforce SSL connection` is set to `ENABLED` for MySQL Database Server.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_28/a25020b044579b1a99b4aebf98a7eba9", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "MySQLServerSSLEnforcementEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for MySQL Database Server.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 35, "ruleId": "CKV_AZURE_28", "ruleName": "MySQLServerSSLEnforcementEnabled", "contextText": "35 resource \"azurerm_mysql_server\" \"example\" {\n", "snippetText": "35 resource \"azurerm_mysql_server\" \"example\" {\n  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"\n  location            = azurerm_resource_group.example.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server.", "description": "Ensure `Enforce SSL connection` is set to `ENABLED` for PostgreSQL Database Server.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_29/939b5d8b7a2b9e74cd1527c533fdf6b9", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "PostgreSQLServerSSLEnforcementEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 54, "ruleId": "CKV_AZURE_29", "ruleName": "PostgreSQLServerSSLEnforcementEnabled", "contextText": "54 resource \"azurerm_postgresql_server\" \"example\" {\n", "snippetText": "54 resource \"azurerm_postgresql_server\" \"example\" {\n  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"\n  location                     = azurerm_resource_group.example.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server.", "description": "Ensure server parameter `connection_throttling` is set to `ON` for PostgreSQL Database Server.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_32/094da0e356548091782f2d5b310b2de5", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "PostgreSQLServerConnectionThrottlingEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 69, "ruleId": "CKV_AZURE_32", "ruleName": "PostgreSQLServerConnectionThrottlingEnabled", "contextText": "69 resource \"azurerm_postgresql_configuration\" \"thrtottling_config\" {\n", "snippetText": "69 resource \"azurerm_postgresql_configuration\" \"thrtottling_config\" {\n  name                = \"connection_throttling\"\n  resource_group_name = azurerm_resource_group.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server.", "description": "Ensure server parameter `log_checkpoints` is set to `ON` for PostgreSQL Database Server.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_30/3f7e77c963fee68a9e30b7f2675447c6", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "PostgreSQLServerLogCheckpointsEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/sql.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 76, "ruleId": "CKV_AZURE_30", "ruleName": "PostgreSQLServerLogCheckpointsEnabled", "contextText": "76 resource \"azurerm_postgresql_configuration\" \"example\" {\n", "snippetText": "76 resource \"azurerm_postgresql_configuration\" \"example\" {\n  name                = \"log_checkpoints\"\n  resource_group_name = azurerm_resource_group.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Azure managed disk have encryption enabled.", "description": "Ensure Azure managed disk have encryption enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_2/bfe27b43de43219f02a57e0a4f3a05da", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "AzureManagedDiscEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Azure managed disk have encryption enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/storage.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_AZURE_2", "ruleName": "AzureManagedDiscEncryption", "contextText": "1 resource \"azurerm_managed_disk\" \"example\" {\n", "snippetText": "1 resource \"azurerm_managed_disk\" \"example\" {\n  name                 = \"terragoat-disk-${var.environment}\"\n  location             = var.location\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure default network access rule for Storage Accounts is set to deny.", "description": "Ensure default network access rule for Storage Accounts is set to deny.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_35/f7d46a79fd7294dbd93d0b72da157017", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "StorageAccountDefaultNetworkAccessDeny", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure default network access rule for Storage Accounts is set to deny.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/storage.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 13, "ruleId": "CKV_AZURE_35", "ruleName": "StorageAccountDefaultNetworkAccessDeny", "contextText": "13 resource \"azurerm_storage_account\" \"example\" {\n", "snippetText": "13 resource \"azurerm_storage_account\" \"example\" {\n  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n  resource_group_name      = azurerm_resource_group.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Storage logging is enabled for Queue service for read, write and delete requests.", "description": "Ensure Storage logging is enabled for Queue service for read, write and delete requests.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_33/0bcecb2e53789a06bef9427075b1408e", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "StorageAccountLoggingQueueServiceEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Storage logging is enabled for Queue service for read, write and delete requests.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/storage.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 13, "ruleId": "CKV_AZURE_33", "ruleName": "StorageAccountLoggingQueueServiceEnabled", "contextText": "13 resource \"azurerm_storage_account\" \"example\" {\n", "snippetText": "13 resource \"azurerm_storage_account\" \"example\" {\n  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n  resource_group_name      = azurerm_resource_group.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Storage Account is using the latest version of TLS encryption.", "description": "Ensure Storage Account is using the latest version of TLS encryption.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_44/9eeb3fa3ee247ec6c8a49a6aed5144c7", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "StorageAccountMinimumTlsVersion", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Storage Account is using the latest version of TLS encryption.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/storage.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 13, "ruleId": "CKV_AZURE_44", "ruleName": "StorageAccountMinimumTlsVersion", "contextText": "13 resource \"azurerm_storage_account\" \"example\" {\n", "snippetText": "13 resource \"azurerm_storage_account\" \"example\" {\n  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n  resource_group_name      = azurerm_resource_group.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that 'Secure transfer required' is set to 'Enabled'.", "description": "Ensure that `Secure transfer required` is set to `Enabled`.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_3/28d5311bc9ea62f6bb87d5de06350ccf", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "StorageAccountsTransportEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that 'Secure transfer required' is set to 'Enabled'.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/storage.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 13, "ruleId": "CKV_AZURE_3", "ruleName": "StorageAccountsTransportEncryption", "contextText": "13 resource \"azurerm_storage_account\" \"example\" {\n", "snippetText": "13 resource \"azurerm_storage_account\" \"example\" {\n  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n  resource_group_name      = azurerm_resource_group.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access.", "description": "Ensure `Trusted Microsoft Services` is enabled for Storage Account access.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_AZURE_36/2db381efd50730c32a8aefeb912758cd", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "StorageAccountAzureServicesAccessEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/azure/storage.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 42, "ruleId": "CKV_AZURE_36", "ruleName": "StorageAccountAzureServicesAccessEnabled", "contextText": "42 resource \"azurerm_storage_account_network_rules\" \"test\" {\n", "snippetText": "42 resource \"azurerm_storage_account_network_rules\" \"test\" {\n  resource_group_name  = azurerm_resource_group.example.name\n  storage_account_name = azurerm_storage_account.example.name\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all Cloud SQL database instance have backup configuration enabled.", "description": "Ensure all Cloud SQL database instance have backup configuration enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_14/019ab64451947576a5c4de9a7067f9c5", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleCloudSqlBackupConfiguration", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all Cloud SQL database instance have backup configuration enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/big_data.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_GCP_14", "ruleName": "GoogleCloudSqlBackupConfiguration", "contextText": "1 resource google_sql_database_instance \"master_instance\" {\n", "snippetText": "1 resource google_sql_database_instance \"master_instance\" {\n  name             = \"terragoat-${var.environment}-master\"\n  database_version = \"POSTGRES_11\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that Cloud SQL database Instances are not open to the world.", "description": "Ensure that Cloud SQL database Instances are not open to the world.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_11/69526d3d2fc0e5c8e68d44f361f3cbad", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleCloudSqlDatabasePublicallyAccessible", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that Cloud SQL database Instances are not open to the world.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/big_data.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_GCP_11", "ruleName": "GoogleCloudSqlDatabasePublicallyAccessible", "contextText": "1 resource google_sql_database_instance \"master_instance\" {\n", "snippetText": "1 resource google_sql_database_instance \"master_instance\" {\n  name             = \"terragoat-${var.environment}-master\"\n  database_version = \"POSTGRES_11\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure all Cloud SQL database instance requires all incoming connections to use SSL.", "description": "Ensure all Cloud SQL database instance requires all incoming connections to use SSL.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_6/145b71420d6766a18f6d981b0ad4ed35", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleCloudSqlDatabaseRequireSsl", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure all Cloud SQL database instance requires all incoming connections to use SSL.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/big_data.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_GCP_6", "ruleName": "GoogleCloudSqlDatabaseRequireSsl", "contextText": "1 resource google_sql_database_instance \"master_instance\" {\n", "snippetText": "1 resource google_sql_database_instance \"master_instance\" {\n  name             = \"terragoat-${var.environment}-master\"\n  database_version = \"POSTGRES_11\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that BigQuery datasets are not anonymously or publicly accessible.", "description": "Ensure that BigQuery datasets are not anonymously or publicly accessible.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_15/c3f8364a0bfbf0b53150114d93991d1f", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "GoogleBigQueryDatasetPublicACL", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that BigQuery datasets are not anonymously or publicly accessible.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/big_data.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 21, "ruleId": "CKV_GCP_15", "ruleName": "GoogleBigQueryDatasetPublicACL", "contextText": "21 resource google_bigquery_dataset \"dataset\" {\n", "snippetText": "21 resource google_bigquery_dataset \"dataset\" {\n  dataset_id = \"terragoat_${var.environment}_dataset\"\n  access {\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Google storage bucket have encryption enabled.", "description": "Ensure Google storage bucket have encryption enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_5/20b6f466af9c046f0df363f856b26266", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "GoogleStorageBucketEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Google storage bucket have encryption enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gcs.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_GCP_5", "ruleName": "GoogleStorageBucketEncryption", "contextText": "1 resource \"google_storage_bucket\" \"terragoat_website\" {\n", "snippetText": "1 resource \"google_storage_bucket\" \"terragoat_website\" {\n  name          = \"terragot-${var.environment}\"\n  force_destroy = true\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that Cloud Storage buckets have uniform bucket-level access enabled.", "description": "Ensure that Cloud Storage buckets have uniform bucket-level access enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_29/ae573067f83fb3ed43e1632c3305ca9a", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleStorageBucketUniformAccess", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that Cloud Storage buckets have uniform bucket-level access enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gcs.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 1, "ruleId": "CKV_GCP_29", "ruleName": "GoogleStorageBucketUniformAccess", "contextText": "1 resource \"google_storage_bucket\" \"terragoat_website\" {\n", "snippetText": "1 resource \"google_storage_bucket\" \"terragoat_website\" {\n  name          = \"terragot-${var.environment}\"\n  force_destroy = true\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that Cloud Storage bucket is not anonymously or publicly accessible.", "description": "Ensure that Cloud Storage bucket is not anonymously or publicly accessible.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_28/501e13b3fdbaf719fc15449bdba0c378", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "GoogleStorageBucketNotPublic", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that Cloud Storage bucket is not anonymously or publicly accessible.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gcs.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_28", "ruleName": "GoogleStorageBucketNotPublic", "contextText": "6 resource \"google_storage_bucket_iam_binding\" \"allow_public_read\" {\n", "snippetText": "6 resource \"google_storage_bucket_iam_binding\" \"allow_public_read\" {\n  bucket  = google_storage_bucket.terragoat_website.id\n  members = [\"allUsers\"]\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Kubernetes Cluster is created with Alias IP ranges enabled.", "description": "Ensure Kubernetes Cluster is created with Alias IP ranges enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_23/c9ff5b7640d7dd6c218d6dc767e94ea8", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEAliasIpEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Kubernetes Cluster is created with Alias IP ranges enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_23", "ruleName": "GKEAliasIpEnabled", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure GKE basic auth is disabled.", "description": "Ensure GKE basic auth is disabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_19/51432c0a18d64f97fd682b41f79955a1", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEBasicAuth", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure GKE basic auth is disabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_19", "ruleName": "GKEBasicAuth", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure a client certificate is used by clients to authenticate to Kubernetes Engine Clusters.", "description": "Ensure a client certificate is used by clients to authenticate to Kubernetes Engine Clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_13/cefda9fe56d90ed64a15efeb19e700c3", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEClientCertificateEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure a client certificate is used by clients to authenticate to Kubernetes Engine Clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_13", "ruleName": "GKEClientCertificateEnabled", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters.", "description": "Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_1/ba4e718f7cad7ad7ec93031d68583e71", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEClusterLogging", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_1", "ruleName": "GKEClusterLogging", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters.", "description": "Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_7/35b3800b8780a2d350f769516bb305c6", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEDisableLegacyAuth", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_7", "ruleName": "GKEDisableLegacyAuth", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Kubernetes Clusters are configured with Labels.", "description": "Ensure Kubernetes Clusters are configured with Labels.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_21/acb157a97bd9d316a88f9fb86ca93306", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEHasLabels", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Kubernetes Clusters are configured with Labels.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_21", "ruleName": "GKEHasLabels", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters.", "description": "Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_8/34c0a324830312703f720a895c2455e3", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEMonitoringEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_8", "ruleName": "GKEMonitoringEnabled", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Network Policy is enabled on Kubernetes Engine Clusters.", "description": "Ensure Network Policy is enabled on Kubernetes Engine Clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_12/ecd58e0967f578ae205897aaf68f6b55", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKENetworkPolicyEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Network Policy is enabled on Kubernetes Engine Clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_12", "ruleName": "GKENetworkPolicyEnabled", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure PodSecurityPolicy controller is enabled on the Kubernetes Engine Clusters.", "description": "Ensure PodSecurityPolicy controller is enabled on the Kubernetes Engine Clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_24/2c0a0bfe72b67e5b30f1feaf6bac1d4e", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEPodSecurityPolicyEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure PodSecurityPolicy controller is enabled on the Kubernetes Engine Clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_24", "ruleName": "GKEPodSecurityPolicyEnabled", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Kubernetes Cluster is created with Private cluster enabled.", "description": "Ensure Kubernetes Cluster is created with Private cluster enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_25/ea25ff9d258a3612bd242561d5f90462", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEPrivateClusterConfig", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Kubernetes Cluster is created with Private cluster enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_25", "ruleName": "GKEPrivateClusterConfig", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure GKE Control Plane is not public.", "description": "Ensure GKE Control Plane is not public.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_18/12552cb3b9bd343c0a9b019e4000729b", "severity": "critical", "owasp_category": "a6-misconfiguration", "category": "GKEPublicControlPlane", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure GKE Control Plane is not public.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 6, "ruleId": "CKV_GCP_18", "ruleName": "GKEPublicControlPlane", "contextText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n", "snippetText": "6 resource \"google_container_cluster\" \"workload_cluster\" {\n  name               = \"terragoat-${var.environment}-cluster\"\n  logging_service    = \"none\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure 'Automatic node repair' is enabled for Kubernetes Clusters.", "description": "Ensure `Automatic node repair` is enabled for Kubernetes Clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_9/ba19edbf5274b6d8f77e97e3516a82d9", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKENodePoolAutoRepairEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure 'Automatic node repair' is enabled for Kubernetes Clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 24, "ruleId": "CKV_GCP_9", "ruleName": "GKENodePoolAutoRepairEnabled", "contextText": "24 resource google_container_node_pool \"custom_node_pool\" {\n", "snippetText": "24 resource google_container_node_pool \"custom_node_pool\" {\n  cluster  = google_container_cluster.workload_cluster.name\n  location = var.region\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure 'Automatic node upgrade' is enabled for Kubernetes Clusters.", "description": "Ensure `Automatic node upgrade` is enabled for Kubernetes Clusters.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_10/e5b7d0a819a9211e75b7acaf3fedda4b", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKENodePoolAutoUpgradeEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure 'Automatic node upgrade' is enabled for Kubernetes Clusters.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 24, "ruleId": "CKV_GCP_10", "ruleName": "GKENodePoolAutoUpgradeEnabled", "contextText": "24 resource google_container_node_pool \"custom_node_pool\" {\n", "snippetText": "24 resource google_container_node_pool \"custom_node_pool\" {\n  cluster  = google_container_cluster.workload_cluster.name\n  location = var.region\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image.", "description": "Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_22/c87ac20f74338e5a0d422df49cfdd5a7", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GKEUseCosImage", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/gke.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 24, "ruleId": "CKV_GCP_22", "ruleName": "GKEUseCosImage", "contextText": "24 resource google_container_node_pool \"custom_node_pool\" {\n", "snippetText": "24 resource google_container_node_pool \"custom_node_pool\" {\n  cluster  = google_container_cluster.workload_cluster.name\n  location = var.region\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK).", "description": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK).\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_38/506892441056b82d89d827d90f0ac8b8", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeBootDiskEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK).", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/instances.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 3, "ruleId": "CKV_GCP_38", "ruleName": "GoogleComputeBootDiskEncryption", "contextText": "3 resource google_compute_instance \"server\" {\n", "snippetText": "3 resource google_compute_instance \"server\" {\n  machine_type = \"n1-standard-1\"\n  name         = \"terragoat-${var.environment}-machine\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that instances are not configured to use the default service account.", "description": "Ensure that instances are not configured to use the default service account.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_30/1c0be983f23a38c30d511c2b1217e642", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeDefaultServiceAccount", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that instances are not configured to use the default service account.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/instances.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 3, "ruleId": "CKV_GCP_30", "ruleName": "GoogleComputeDefaultServiceAccount", "contextText": "3 resource google_compute_instance \"server\" {\n", "snippetText": "3 resource google_compute_instance \"server\" {\n  machine_type = \"n1-standard-1\"\n  name         = \"terragoat-${var.environment}-machine\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that IP forwarding is not enabled on Instances.", "description": "Ensure that IP forwarding is not enabled on Instances.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_36/635edae0050ba509320062a3e73bf109", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeIPForward", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that IP forwarding is not enabled on Instances.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/instances.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 3, "ruleId": "CKV_GCP_36", "ruleName": "GoogleComputeIPForward", "contextText": "3 resource google_compute_instance \"server\" {\n", "snippetText": "3 resource google_compute_instance \"server\" {\n  machine_type = \"n1-standard-1\"\n  name         = \"terragoat-${var.environment}-machine\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that no instance in the project overrides the project setting for enabling OSLogin(OSLogin needs to be enabled in prject metadata for all instances).", "description": "Ensure that no instance in the project overrides the project setting for enabling OSLogin(OSLogin needs to be enabled in prject metadata for all instances).\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_34/9067659be1a5cd67d5f0b0536215fcb1", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeInstanceOSLogin", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that no instance in the project overrides the project setting for enabling OSLogin(OSLogin needs to be enabled in prject metadata for all instances).", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/instances.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 3, "ruleId": "CKV_GCP_34", "ruleName": "GoogleComputeInstanceOSLogin", "contextText": "3 resource google_compute_instance \"server\" {\n", "snippetText": "3 resource google_compute_instance \"server\" {\n  machine_type = \"n1-standard-1\"\n  name         = \"terragoat-${var.environment}-machine\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure 'Enable connecting to serial ports' is not enabled for VM Instance.", "description": "Ensure `Enable connecting to serial ports` is not enabled for VM Instance.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_35/0e1ab2c92256c0d9d71db16e5cf4387f", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeSerialPorts", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure 'Enable connecting to serial ports' is not enabled for VM Instance.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/instances.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 3, "ruleId": "CKV_GCP_35", "ruleName": "GoogleComputeSerialPorts", "contextText": "3 resource google_compute_instance \"server\" {\n", "snippetText": "3 resource google_compute_instance \"server\" {\n  machine_type = \"n1-standard-1\"\n  name         = \"terragoat-${var.environment}-machine\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Compute instances are launched with Shielded VM enabled.", "description": "Ensure Compute instances are launched with Shielded VM enabled.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_39/0f8d6c263df615867e475f010a95dcba", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeShieldedVM", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Compute instances are launched with Shielded VM enabled.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/instances.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 3, "ruleId": "CKV_GCP_39", "ruleName": "GoogleComputeShieldedVM", "contextText": "3 resource google_compute_instance \"server\" {\n", "snippetText": "3 resource google_compute_instance \"server\" {\n  machine_type = \"n1-standard-1\"\n  name         = \"terragoat-${var.environment}-machine\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances.", "description": "Ensure `Block Project-wide SSH keys` is enabled for VM instances.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_32/de90961916d08cb46bca02914e28a094", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComupteBlockProjectSSH", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/instances.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 3, "ruleId": "CKV_GCP_32", "ruleName": "GoogleComupteBlockProjectSSH", "contextText": "3 resource google_compute_instance \"server\" {\n", "snippetText": "3 resource google_compute_instance \"server\" {\n  machine_type = \"n1-standard-1\"\n  name         = \"terragoat-${var.environment}-machine\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK).", "description": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK).\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_37/ab6b711937dcaa0a43a14c5f3b957a5d", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeDiskEncryption", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK).", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/instances.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 26, "ruleId": "CKV_GCP_37", "ruleName": "GoogleComputeDiskEncryption", "contextText": "26 resource google_compute_disk \"unencrypted_disk\" {\n", "snippetText": "26 resource google_compute_disk \"unencrypted_disk\" {\n  name = \"terragoat-${var.environment}-disk\"\n}"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network.", "description": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_26/11da137544673c6af7299db36480f12f", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleSubnetworkLoggingEnabled", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/networks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 7, "ruleId": "CKV_GCP_26", "ruleName": "GoogleSubnetworkLoggingEnabled", "contextText": "7 resource \"google_compute_subnetwork\" \"public-subnetwork\" {\n", "snippetText": "7 resource \"google_compute_subnetwork\" \"public-subnetwork\" {\n  name          = \"terragoat-${var.environment}-public-subnetwork\"\n  ip_cidr_range = \"10.0.0.0/24\"\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Google compute firewall ingress does not allow unrestricted ssh access.", "description": "Ensure Google compute firewall ingress does not allow unrestricted ssh access.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_2/b3b87fb938c655cba8a66152d0e716f0", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeFirewallUnrestrictedIngress22", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Google compute firewall ingress does not allow unrestricted ssh access.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/networks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 19, "ruleId": "CKV_GCP_2", "ruleName": "GoogleComputeFirewallUnrestrictedIngress22", "contextText": "19 resource \"google_compute_firewall\" \"allow_all\" {\n", "snippetText": "19 resource \"google_compute_firewall\" \"allow_all\" {\n  name          = \"terragoat-${var.environment}-firewall\"\n  network       = google_compute_network.vpc.id\n"}, "tags": []}, {"app": "terragoat", "type": "extscan", "title": "Ensure Google compute firewall ingress does not allow unrestricted rdp access.", "description": "Ensure Google compute firewall ingress does not allow unrestricted rdp access.\n\n## Documentation\n\n- [AWS Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)\n- [Azure Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)\n- [Google Cloud Terraform](https://registry.terraform.io/providers/hashicorp/google/latest/docs)", "internal_id": "CKV_GCP_3/e0fd7d4707ad1d684d6fe4e3039b121b", "severity": "moderate", "owasp_category": "a6-misconfiguration", "category": "GoogleComputeFirewallUnrestrictedIngress3389", "details": {"repoContext": {"gitProvider": "github", "ciProvider": "", "repositoryName": "terragoat", "repositoryUri": "https://github.com/bridgecrewio/terragoat", "revisionId": "0ffedfb9dacd7bb7702447b2d749b94a5cc06d07", "branch": "master", "invokedBy": "GitHub Action <action@github.com>", "pullRequest": false, "botUser": false}, "name": "Ensure Google compute firewall ingress does not allow unrestricted rdp access.", "tags": "Scan", "fileName": "file:///home/ec2-user/vulnerableapps/terragoat/terraform/gcp/networks.tf", "DATA_TYPE": "OSS_SCAN", "lineNumber": 19, "ruleId": "CKV_GCP_3", "ruleName": "GoogleComputeFirewallUnrestrictedIngress3389", "contextText": "19 resource \"google_compute_firewall\" \"allow_all\" {\n", "snippetText": "19 resource \"google_compute_firewall\" \"allow_all\" {\n  name          = \"terragoat-${var.environment}-firewall\"\n  network       = google_compute_network.vpc.id\n"}, "tags": []}]}